# 在线音乐播放器 - 需求规格说明书

## 1. 项目概述

### 1.1 项目背景

随着互联网技术的快速发展，在线音乐服务已成为人们日常生活中不可或缺的一部分。用户对音乐播放器的需求已从简单的播放功能，扩展到个性化推荐、歌词同步、播放列表管理等多元化需求。

本项目旨在开发一个基于现代 Web 技术的在线音乐播放器，为用户提供流畅、美观、功能丰富的音乐播放体验。

### 1.2 项目目标

1. **核心目标**：构建一个功能完善的在线音乐播放平台
2. **技术目标**：采用现代前端技术栈，实现高性能、可维护的 Web 应用
3. **用户体验目标**：提供直观、流畅、美观的用户界面

### 1.3 目标用户

| 用户类型 | 特征描述 | 主要需求 |
|----------|----------|----------|
| 普通听众 | 日常听音乐的用户 | 播放、搜索、收藏歌曲 |
| 音乐爱好者 | 对音乐有较高要求的用户 | 歌词同步、播放列表管理、高质量播放 |
| 内容创作者 | 上传分享音乐的用户 | 音乐上传、元数据编辑 |

---

## 2. 功能需求

### 2.1 功能架构图

```
┌─────────────────────────────────────────────────────────────┐
│                      在线音乐播放器                           │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │
│  │   用户系统   │  │  音乐播放   │  │  内容管理   │          │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤          │
│  │ • 用户注册  │  │ • 播放控制  │  │ • 歌曲上传  │          │
│  │ • 用户登录  │  │ • 进度控制  │  │ • 歌曲搜索  │          │
│  │ • 收藏管理  │  │ • 音量控制  │  │ • 歌曲删除  │          │
│  │ • 播放历史  │  │ • 播放模式  │  │ • 播放列表  │          │
│  └─────────────┘  │ • 歌词同步  │  └─────────────┘          │
│                   └─────────────┘                           │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 核心功能模块

#### 2.2.1 音乐播放模块

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 播放/暂停 | 控制音乐的播放和暂停 | P0 |
| 上一曲/下一曲 | 切换到播放列表中的上/下一首歌曲 | P0 |
| 进度控制 | 拖动进度条跳转到指定位置 | P0 |
| 音量控制 | 调节播放音量，支持静音 | P0 |
| 播放模式 | 顺序播放、单曲循环、随机播放、列表循环 | P1 |
| 歌词同步 | 实时显示当前播放位置的歌词 | P1 |
| 全屏播放 | 提供沉浸式的全屏播放界面 | P2 |
| 音频可视化 | 显示音频频谱动画效果 | P2 |

#### 2.2.2 用户系统模块

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 用户注册 | 新用户创建账号 | P0 |
| 用户登录 | 已注册用户登录系统 | P0 |
| 用户登出 | 退出当前登录状态 | P0 |
| 收藏歌曲 | 将喜欢的歌曲添加到收藏 | P1 |
| 取消收藏 | 从收藏列表移除歌曲 | P1 |
| 播放历史 | 记录用户的播放历史 | P1 |
| 播放记忆 | 记住上次播放的歌曲和进度 | P2 |

#### 2.2.3 内容管理模块

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 歌曲列表 | 展示所有可播放的歌曲 | P0 |
| 歌曲搜索 | 按歌名、歌手、专辑搜索 | P0 |
| 歌曲上传 | 上传音乐文件及封面、歌词 | P1 |
| 歌曲删除 | 删除已上传的歌曲 | P1 |
| 播放列表 | 创建和管理自定义播放列表 | P1 |
| 流派筛选 | 按音乐流派筛选歌曲 | P2 |

#### 2.2.4 辅助功能模块

| 功能 | 描述 | 优先级 |
|------|------|--------|
| 快捷键支持 | 支持键盘快捷键控制播放 | P2 |
| 搜索历史 | 保存用户的搜索记录 | P2 |
| 错误处理 | 优雅处理应用错误 | P1 |
| 响应式布局 | 适配不同屏幕尺寸 | P1 |

---

## 3. 非功能需求

### 3.1 性能需求

| 指标 | 要求 |
|------|------|
| 页面加载时间 | 首次加载 < 3秒 |
| 播放响应时间 | 点击播放到开始播放 < 1秒 |
| 搜索响应时间 | 搜索结果返回 < 500ms |

### 3.2 兼容性需求

| 浏览器 | 最低版本 |
|--------|----------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

### 3.3 安全需求

1. 用户密码使用 bcrypt 加密存储
2. API 请求使用 JWT Token 认证
3. 敏感操作需要用户登录验证

### 3.4 可用性需求

1. 界面简洁直观，符合用户使用习惯
2. 提供清晰的操作反馈和错误提示
3. 支持键盘快捷键操作

---

## 4. 用户界面设计

### 4.1 页面结构

```
┌────────────────────────────────────────────────────────┐
│                        头部导航栏                        │
│  [Logo] [搜索框] [播放历史] [播放列表] [上传] [用户]     │
├────────────────────────────────────────────────────────┤
│                                                        │
│                      歌曲列表区域                        │
│                                                        │
│  ┌──────────────────────────────────────────────────┐  │
│  │ [封面] 歌曲名称 - 歌手    专辑名      时长  操作  │  │
│  │ [封面] 歌曲名称 - 歌手    专辑名      时长  操作  │  │
│  │ [封面] 歌曲名称 - 歌手    专辑名      时长  操作  │  │
│  └──────────────────────────────────────────────────┘  │
│                                                        │
├────────────────────────────────────────────────────────┤
│                      底部播放控制栏                      │
│  [封面][歌曲信息] [模式][上一曲][播放][下一曲] [音量]   │
│                    [进度条]                             │
└────────────────────────────────────────────────────────┘
```

### 4.2 全屏播放界面

```
┌────────────────────────────────────────────────────────┐
│ [返回]                                      [播放列表] │
│                                                        │
│         ┌─────────────┐    ┌─────────────────────┐    │
│         │             │    │                     │    │
│         │   唱片封面   │    │      歌词区域       │    │
│         │   (旋转)    │    │    (高亮当前行)     │    │
│         │             │    │                     │    │
│         └─────────────┘    └─────────────────────┘    │
│                                                        │
│         [音频可视化]                                    │
│                                                        │
├────────────────────────────────────────────────────────┤
│                      播放控制区域                        │
│            [进度条]  00:00 ─────○───── 03:45           │
│      [模式] [上一曲] [播放/暂停] [下一曲] [音量]        │
└────────────────────────────────────────────────────────┘
```

### 4.3 交互规范

| 操作 | 反馈 |
|------|------|
| 鼠标悬停歌曲 | 显示播放按钮和操作菜单 |
| 点击歌曲 | 开始播放并高亮当前歌曲 |
| 拖动进度条 | 实时显示时间并跳转 |
| 收藏/取消收藏 | 心形图标状态切换 + 提示 |

---

## 5. 数据需求

### 5.1 数据实体

#### 用户 (User)
| 字段 | 类型 | 描述 |
|------|------|------|
| id | String | 用户唯一标识 |
| email | String | 邮箱地址 |
| username | String | 用户名 |
| password | String | 加密密码 |
| createdAt | DateTime | 创建时间 |

#### 歌曲 (Song)
| 字段 | 类型 | 描述 |
|------|------|------|
| id | String | 歌曲唯一标识 |
| title | String | 歌曲标题 |
| artist | String | 艺术家 |
| album | String | 专辑名 |
| duration | Float | 时长(秒) |
| filePath | String | 音频文件路径 |
| coverUrl | String | 封面图片路径 |
| lyricsPath | String | 歌词文件路径 |
| genre | String | 音乐流派 |
| playCount | Int | 播放次数 |

#### 播放列表 (Playlist)
| 字段 | 类型 | 描述 |
|------|------|------|
| id | String | 播放列表唯一标识 |
| name | String | 播放列表名称 |
| description | String | 描述 |
| userId | String | 创建者ID |
| songs | Song[] | 包含的歌曲 |

#### 收藏 (Favorite)
| 字段 | 类型 | 描述 |
|------|------|------|
| id | String | 收藏记录唯一标识 |
| userId | String | 用户ID |
| songId | String | 歌曲ID |
| createdAt | DateTime | 收藏时间 |

### 5.2 数据关系图

```
┌─────────┐       ┌─────────┐       ┌─────────┐
│  User   │───────│Favorite │───────│  Song   │
└─────────┘  1:N  └─────────┘  N:1  └─────────┘
     │                                    │
     │ 1:N                           N:M  │
     ▼                                    ▼
┌─────────┐                        ┌─────────────┐
│Playlist │────────────────────────│PlaylistSong │
└─────────┘           1:N          └─────────────┘
```

---

## 6. 接口需求

### 6.1 API 列表

#### 歌曲相关

| 方法 | 路径 | 描述 |
|------|------|------|
| GET | /api/songs | 获取歌曲列表 |
| GET | /api/songs/search | 搜索歌曲 |
| GET | /api/songs/:id | 获取歌曲详情 |
| POST | /api/songs | 上传歌曲 |
| PUT | /api/songs/:id | 更新歌曲信息 |
| DELETE | /api/songs/:id | 删除歌曲 |
| POST | /api/songs/:id/play | 增加播放次数 |

#### 用户相关

| 方法 | 路径 | 描述 |
|------|------|------|
| POST | /api/users/register | 用户注册 |
| POST | /api/users/login | 用户登录 |
| GET | /api/users/:id | 获取用户信息 |
| GET | /api/users/:id/favorites | 获取收藏列表 |
| POST | /api/users/:id/favorites | 添加收藏 |
| DELETE | /api/users/:id/favorites/:songId | 取消收藏 |

#### 播放列表相关

| 方法 | 路径 | 描述 |
|------|------|------|
| GET | /api/playlists | 获取播放列表 |
| GET | /api/playlists/:id | 获取播放列表详情 |
| POST | /api/playlists | 创建播放列表 |
| PUT | /api/playlists/:id | 更新播放列表 |
| DELETE | /api/playlists/:id | 删除播放列表 |
| POST | /api/playlists/:id/songs | 添加歌曲到列表 |
| DELETE | /api/playlists/:id/songs/:songId | 从列表移除歌曲 |

---

## 7. 约束与假设

### 7.1 技术约束

1. 前端必须使用 React 框架
2. 样式必须使用 Tailwind CSS
3. 后端使用 Node.js + Express
4. 数据库使用 SQLite (通过 Prisma ORM)

### 7.2 假设条件

1. 用户具有基本的互联网使用能力
2. 用户使用现代浏览器访问应用
3. 服务器具备足够的存储空间存放音乐文件

---

## 8. 术语表

| 术语 | 定义 |
|------|------|
| SPA | Single Page Application，单页面应用 |
| MVVM | Model-View-ViewModel，前端架构模式 |
| JWT | JSON Web Token，用于身份认证的令牌 |
| REST | Representational State Transfer，API 设计风格 |
| LRC | 歌词文件格式，支持时间同步 |

---

## 9. 版本历史

| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| 1.0 | 2024-12-19 | 初始版本 | - |

